%\input{head.tex}
%\begin{document}
	\newpage
	\section{组合数学}
	\subsection{二项式反演}	
	\subsubsection{基本内容}
	如果
	$$
	g(n)=\sum_{i=0}^n\binom{n}{i}f(i)
	$$
	则
	$$
	f(n)=\sum_{i=0}^n(-1)^{n-i}\binom nif(i)
	$$
	证明：\\
	基于 $\sum(-1)^i \binom ni=[n=1]$ ，有
	$$
	\begin{aligned}
	f(n)=&\sum_{i=0}^n[n=i]\binom nif(i)
	\\=&\sum_{i=0}^n\sum_{j=0}^{n-i}(-1)^j\binom{n-i}jf(i)
	\\=&\sum_{j=0}^n(-1)^j\sum_{i=0}^{n-j}\binom ni\binom{n-i}jf(i)
	\\=&\sum_{j=0}^n(-1)^j\sum_{i=0}^{n-j}\binom nj \binom {n-j}if(i)
	\\=&\sum_{j=0}^n(-1)^j\binom njg(n-j)
	\\=&\sum_{j=0}^n (-1)^{n-j}\binom njg(j)
	\end{aligned}
	$$\\
	\subsubsection{推论}这个公式有一个更优美的形式\\
	将 $f(n)\rightarrow(-1)^nf(n)$ ，可以得到\\
	若
	$$
	g(n)=\sum_{i=0}^n(-1)^i\binom nif(i)
	$$
	则
	$$
	f(n)=\sum_{i=0}^n(-1)^i\binom nig(i)
	$$\\
	~\\	
	\subsubsection{另一个方向的二项式反演}~\\
	若
	$$
	g(n)=\sum_{i\ge n}(-1)^{i}\binom in f(i)
	$$
	则
	$$
	f(n)=\sum_{i\ge n}(-1)^{i}\binom in g(i)
	$$
	证明：\\
	好像网上都没有找到证明，这里就写一下。。\\
	同样的方法\\
	$$
	\begin{aligned}
	f(n)=&\sum_{i\ge n}(-1)^{i-n}\binom in[i=n]f(i)
	\\=&\sum_{i\ge n}(-1)^{i-n}\binom in\sum_{j=0}^{i-n}(-1)^j\binom{i-n}j f(i)
	\\=&\sum_{j\ge 0}\sum_{i\ge n+j}(-1)^{i-n}(-1)^j\binom in\binom{i-n}jf(i)
	\\=&\sum_{j\ge n}\sum_{i\ge j}(-1)^{i-n}(-1)^{j-n} \binom in\binom{i-n}{j-n}f(i)
	\\=&\sum_{j\ge n}\sum_{i\ge j}(-1)^{i+j}\binom ij \binom jnf(i)
	\\=&\sum_{j\ge n}(-1)^j\binom jn\sum_{i\ge j}(-1)^i\binom ijf(i)
	\\=&\sum_{j\ge n}(-1)^j\binom jng(j)
	\end{aligned}
	$$
	\newpage
	\subsection{普通型生成函数(OGF)}
	普通型生成函数($ordinary$​ $generating$ $function$，下称 $OGF$ )的形式大致如下：\\
	对数列 $f=f_0,f_1,f_2... $ ，其生成函数为
	$$
	F(x)=\sum_{k=1}^{\infty}f_kx^k
	$$
	\subsubsection{常见的 OGF}
	\begin{center}
		\renewcommand\arraystretch{2.3}
		\renewcommand\tabcolsep{40.0pt}
		\begin{tabular}{|c|c|}
			\hline
			数列&OGF\\
			\hline
			$<1,0,0,...>$&$\displaystyle 1$\\
			\hline
			$<1,1,1,...>$&$\displaystyle \frac{1}{1-x}$\\
			\hline
			$<1,2,3,...>$&$\displaystyle \frac{1}{(1-x)^2}$\\
			\hline
			$<1,-1,1,-1,...>$&$\displaystyle \frac{1}{1+x}$\\
			\hline
			$<1,2,1,0,0,...>$&$\displaystyle (1+x)^2$\\
			\hline
			$<1,4,6,4,1,0,0,...>$&$\displaystyle (1+x)^3$\\
			\hline
		\end{tabular}	
	\end{center}
	\subsubsection{ OGF 的性质}
	$$
	\begin{aligned}
	\alpha F(x)+\beta G(x)&=\sum_n(\alpha f_n+\beta g_n)x^n\\
	x^mF(x)&=\sum_n[n\geq m]f_{n-m}x^n\\
	\frac{F(x)-\sum_{i=0}^{m-1}f_ix^i}{x^m}&=\sum_nf_{n+m}x^n\\
	F(cx)&=\sum_nc^nf_nx^n\\
	F^\prime(x)&=\sum_n(n+1)f_{n+1}x^n\\
	\int_0^xF(t)\mathrm{d}t&=\sum_n[n>0]\frac{f_{n-1}}nx^n\\
	F(x)G(x)&=\sum_n\left(\sum_{i=0}^nf_ig_{n-i}\right)x^n
	\end{aligned}
	$$\\
	性质都是多项式的性质，比较好记
	\newpage
	\subsection{指数型生成函数(EGF)}
	指数型生成函数( $exponential$ $generating$ $function$，简称 $EGF$ )的形式大致如下：\\
	对数列 $f=<f_0,f_1,f_2...>$ ，其生成函数为
	$$
	F(x)=\sum_{k=1}^{\infty}f_k\frac{x^k}{n!}
	$$
	其意义体现在其乘法操作上： 
	$$
	F(x)G(x)=\sum_n\left(\sum_{i=0}^n\binom nif_ig_{n-i}\right)x^i
	$$
	多出来的 $\binom{n}{i}$ 告诉我们它适用于排列的计算（相对于 $OGF$ 的普通卷积对应组合）。
	\subsubsection{常见的 EGF}
	\begin{center}
		\renewcommand\arraystretch{2.3}
		\renewcommand\tabcolsep{40.0pt}
		\begin{tabular}{|c|c|}
			\hline
			数列&EFG\\
			\hline
			$<1,1,1,...>$&$e^x$\\
			\hline
			$<0,1,2,...>$&$xe^x$\\
			\hline
			$<1,c,c^2,...>$&$e^{cx}$\\
			\hline
		\end{tabular}
	\end{center}
	\subsubsection{ EGF 的性质}	
	$$
	\begin{aligned}
	\alpha F(x)+\beta G(x)&=\sum_n(\alpha f_n+\beta g_n)\frac{x^n}{n!}\\
	x^mF(x)&=\sum_n[n\geq m]n^{\underline m}f_{n-m}\frac{x^n}{n!}\\
	\frac{F(x)-\sum_{i=0}^{m-1}f_ix^i}{x^m}&=\sum_n\frac1{(n+m)^{\underline m}}f_{n+m}\frac{x^n}{n!}\\
	F(cx)&=\sum_nc^nf_n\frac{x^n}{n!}\\
	F^\prime(x)&=\sum_nf_{n+1}\frac{x^n}{n!}\\
	\int_0^xF(t)\mathrm{d}t&=\sum_n[n>0]f_{n-1}\frac{x^n}{n!}\\
	\sum_{n}n^{\underline k}\frac{x^n}{n!}&=x^ke^x \\
	\sum_{n}(n-1)!\frac{x^n}{n!}&=\ln \frac{1}{1-x} \\
	F(x)G(x)&=\sum_n\left(\sum_{i=0}^n\binom nif_ig_{n-i}\right)\frac{x^n}{n!}
	\end{aligned}
	$$
	\newpage
	\subsection{第一类斯特林数}
	第一类斯特林数是指将 $n$ 个元素划分成为 $m$ 个\textbf{轮换}(或者环)的方案数，记作 $S_1(n,m)$ ，具体数学记作 $n\brack m$
	\paragraph{递推公式}
	$$
	{n\brack m}={n-1\brack m-1}+(n-1){n-1\brack m}
	$$
	证明：\\
	考虑组合意义，当把第 $n$ 个数加入时，要么另开一个环，要么加到已有的环中，有 $n$ 个位置可以插入\\
	\subsubsection{求法}
	这个求法的复杂度是 $O(n^2)$ 的，网上有一个倍增求第一类斯特林数的复杂度为 $O(nlogn)$ \\
	构造 $F_n(x)=\sum {n\brack k}x^k$\\
	然后由斯特林数的递推公式可得
	$$
	F_n(x)=xF_{n-1}(x)+(n-1)F_{n-1}(x)
	$$
	所以有
	$$
	F_n(x)=\prod_{i=0}^{n-1}(x+i)
	$$
	那么考虑分治处理，假设求出了前 $n$ 项系数 $a_0...a_{n-1}$ ，先求后 $n$ 项，有
	$$
	\begin{aligned}
	\prod_{i=n+1}^{2n-1}(x+i)&=\prod_{i=0}^{n-1}(x+n+i)
	\\&=\sum_{i=0}^{n-1}a_i(x+n)^i
	\\&=\sum_{i=0}^{n-1}a_i\sum_{j=0}^{i}\binom{i}{j}n^{i-j}x^j
	\\&=\sum_{i=0}^{n-1}\sum_{j=i}^{n-1}a_j\frac{j!}{i!(j-i)!}n^{j-i}x^i
	\\&=\sum_{i=0}^{n-1}\frac{1}{i!}\sum_{j=i}^{n-1}a_jj!\frac{n^{j-i}}{(j-i)!}x^i
	\end{aligned}
	$$
	对于差固定的卷积，我们可以对其中一个序列进行翻转，就变成普通的卷积了，然后再平移一下即可。。\\
	\paragraph{参考代码}~\\
	\lstinputlisting{./source/stling.cpp}
	\vspace{1cm}
	\subsubsection{部分公式}
	
	$$
	x^{\bar{n}}=\sum_{k=1}^n{n\brack k}x^k\\
	\sum_{k=0}^n{n\brack k}=n!
	$$
	\newpage
	\subsection{第二类斯特林数}
	第二类斯特林数是指将 $n$ 个元素划分成为 $m$ 个\textbf{集合}的方案数，记作 $S_2(n,m)$ ， 具体数学记作 $n\brace m$ 
	\subsubsection{递推公式}
	$$
	{n\brace m}={n-1\brace m-1}+m{n-1\brace m}
	$$
	证明：\\
	考虑组合意义，当把第 $n$ 个数加入时，要么另开一个集合，要么加到已有的环中，有 $m$ 个集合可以加入
	\subsubsection{求法}
	先证下式：
	$$
	{n\brace m}=\frac{1}{m!}\sum_{k=0}^m\binom{m}{k}(-1)^k(m-k)^n
	$$
	证明：\\
	考虑枚举空集 $k$ 的个数，容斥一下即可得到全为非空集的方案数\\
	然后对他进行变形，变成卷积形式
	$$
	{n\brace m}=\sum_{k=0}^{m}\frac{(-1)^k}{k!}\frac{(m-k)^n}{(m-k)!}
	$$
	然后上 $FFT$ 就可以了
	\subsubsection{部分公式}
	$$
	x^n=\sum_{k=1}^{n}{n\brace k}x^{\underline{k}}
	$$
	关于斯特林数其实具体数学里面还有很多公式，不过窝还没能吸收qaq
	\newpage
	\subsection{五边形数}
	五边形数就是从五边形里面弄出来的一个数列，感觉没什么几何意义\\
	五边形数列为 $\displaystyle \{\frac{n(3n-1)}{2} \}$\\
	广义的五边形数是由 $\frac{n(3n-1)}{2}$ 和 $\frac{n(3n+1)}{2}$ 组成的\\
	然后有一个经典的多项式，是组合数学上的欧拉函数 
	$$
	\phi(x)=\prod_{i=1}^\infty (1-x^i)
	$$
	有一个结论
	$$
	\phi(x)=1+\sum_k (-1)^kx^{\frac{k(3k-1)}{2} }+\sum_k(-1)^kx^{\frac{k(3k+1)}{2} }
	$$
	也就是刚好是在广义五边形数上有系数\\
	这个结论就非常舒服了，能够带来不少便利(但是证明很无聊，这里就不给出了)\\
	\vspace{3cm}
	~\\
	\subsection{常见泰勒展开}
	$$
	\begin{aligned}
	e^x=&\sum_k\frac{x^k}{k!}&=&1+\frac{x}{1!}+\frac{x^2}{2!}+\cdots\\
	\ln(1+x)=&\sum_k(-1)^{k+1}\frac{x^k}{k}&=&x-\frac{x^2}{2}+\frac{x^3}{3}+\cdots\\
	\ln(1-x)=&-\sum_k\frac{x^k}{k}&=&-x-\frac{x^2}{2}-\frac{x^3}{3}-\cdots\\
	\sin x=&\sum_k (-1)^k\frac{x^{2k+1}}{(2k+1)!}&=&x-\frac{x^3}{3!}+\frac{x^5}{5!}+\cdots\\
	\cos x=&\sum_k (-1)^k\frac{x^{2k}}{(2k)!}&=&1-\frac{x^2}{2!}+\frac{x^4}{4!}+\cdots\\
	\frac{1}{1-x}=&\sum_k x^k&=&1+x+x^2+x^3+\cdots
	\end{aligned}
	$$
	\newpage
	\subsection{FWT/FMT}
	标记和 FFT 还不太一样，可以手动修改，记得加上 reduce。。\\
	\subsubsection{FWT}
	\lstinputlisting{./source/fwt.cpp}
	\vspace{1cm}
	\subsubsection{FMT(or)}
	\lstinputlisting{./source/fmtor.cpp}
	\vspace{1cm}
	\subsubsection{FMT(and)}
	\lstinputlisting{./source/fmtand.cpp}
	\newpage
	\subsection{子集卷积}
	做子集卷积的时候主要是对集合的交和并都有要求，所以很难找到合适的变换。。然而如果我们记 $a'_{S,i}=[|S|=i]a_S$ 的话，就能将并为空的条件去掉了。。然后剩下或的条件就直接上 FMT 即可。。\\
	然后在乘积的时候可以交换求和顺序，让内存访问连续，效果显著。。\\
	\vspace{2cm}
	\lstinputlisting{./source/subset.cpp}
	\newpage
	\subsection{K次幂前缀和}
	\subsubsection{拉格朗日插值}
	如果知道了多项式的点值 $(x_i,y_i)$ ，可以通过以下方法构造
	$$
	F(x)=\sum_i y_i\frac{\displaystyle\prod_{i\neq j}(x-x_j)}{\displaystyle\prod_{i\neq j}(x_i-x_j)}
	$$
	对 $k$ 幂和，我们知道其为 $k+1$ 次多项式，所以我们需要 $k+2$ 个点来求解 ，最简单的就是 $1,2..,k+2$ ，这样一选，分子分母都可以用前缀积进行表示。然后对每个要求的 $x$ ，对分子分母用前缀和预处理，然后直接求解即可。。复杂度为 $O(k)$\\
	\lstinputlisting{./source/lagrange.cpp}
	~\\
	\subsubsection{扰动法}
	令 $f(k)=\sum_{i=1}^{n} i^k$
	$$
	\begin{aligned}
	(n+1)^{k+1}-n^k&=\sum_{i=0}^{k}\binom{k+1}{i}n^i\\
	(n)^{k+1}-(n-1)^k&=\sum_{i=0}^{k}\binom{k+1}{i}(n-1)^i\\
	&\ldots\\
	2^{k+1}-1^k&=\sum_{i=0}^{k}\binom{k+1}{i}1^i\\
	\end{aligned}
	$$
	对上式求和，有
	$$
	\begin{aligned}
	(n+1)^{k+1}-1&=\sum_{i=0}^{k}\binom{k+1}{i}f(i)\\
	f(k)&=\frac{(n+1)^{k+1}-\sum_{i=0}^{k-1}\binom{k+1}{i}f(i)}{k+1}
	\end{aligned}
	$$
	然后直接分治 FFT 就可以了 
	\newpage
	\subsection{分治FFT}
	只举了一个简单的例子，一般可能会有多项式求逆的做法
	\paragraph{题意}~\\
	
	给定数 $n(n\le10^5)$ ，定义一个排列的价值如下：
	
	如果 $i<j$ 且 $p[i]<p[j]$ ，那么 $i$ 和 $j$ 连边，然后排列的价值等于各个联通块大小的乘积
	
	现在要求所有联通块的价值的平方的和
	
	\paragraph{题解}~\\
	
	首先考虑这个图的形态，可以发现各个联通块中的最右侧的点总是最大的，那么可以看成一些大的点支配了小的点。那么考虑最大的点，他必定会支配在他之前的所有点，然后剩下的点又可以看成一个子问题了。那么设答案为 $f(n)$ ，有
	$$
	f(n) =\sum_{i=1}^{n}A_{n-1}^{i-1}i^2f(n-i)\\
	=(n-1)!\sum_{i=1}^{n}i^2\frac{f(n-i)}{(n-i)!}
	$$
	
	这显然是一个卷积，但是由于是和 $f$ 自身做卷积，所以不能直接做 $FFT$ 。难点就在卷积之前需要把前面的 $f$ 全部求出，所以可以用 $CDQ$ 分治边求边做卷积。复杂度为 $O(nlog^2n)$
	\vspace{3cm}
	~\\
	\lstinputlisting{./source/divfft.cpp}
	\newpage
	\subsection{FFT}
	\lstinputlisting{./source/fft.cpp}
	\newpage
	\subsection{多项式(理论部分)}
	\subsubsection{多项式逆元}
	\paragraph{题意}~\\给定一个 $n-1$ 次多项式 $F(x)$ ，求 $n-1$ 次多项式 $G(x)$ ，满足 $F(x)G(x)\equiv 1\pmod{x^n}$
	\paragraph{题解}~\\
	这个的求解思路如下，若 $m=1$ ，那么 $B(x)=a_0^{-1}$\\
	否则，可以转化为求解
	$$
	\begin{aligned}
	A(x)B'(x)&\equiv&1&\pmod{x^{\lceil\frac{m}{2} \rceil }}
	\end{aligned}
	$$
	那么，两式相减，可得
	$$
	\begin{aligned}
	B(x)-B'(x)&\equiv0&\pmod{x^{\lceil\frac{m}{2} \rceil}}\\
	(B(x)-B'(x))^2&\equiv0&\pmod{x^m}\\
	B^2(x)&\equiv2B(x)B'(x)-{B'}^2(x)&\pmod{x^m}\\
	A(x)B^2(x)&\equiv2A(x)B(x)B'(x)-A(x){B'}^2(x)&\pmod{x^m}\\
	B(x)&\equiv B'(x)(2-A(x)B'(x))&\pmod{x^m}
	\end{aligned}
	$$
	然后就可以递归求解了
	那么也可以看出，该多项式有没有逆元也是看 $a_0$ 的逆元存不存在的，这里所有多项式系数也是在模意义下的
	乘法可以用 $FFT$ 算，复杂度为 $T(n)=T(\frac{n}{2})+O(nlogn)=O(nlogn)$\\
	\vspace{1cm}
	\subsubsection{多项式开方}
	\paragraph{题意}~\\
	给定一个 $n-1$ 次多项式 $F(x)$ ，求 $G(x)$ 使得 $G^2(x)\equiv F(x)\pmod {x^n}$
	\paragraph{题解}~\\
	求 $B(x)$ 满足
	$$
	\begin{aligned}
	B^2(x)&\equiv&A(x)&\pmod{x^m}
	\end{aligned}
	$$
	当 $m=1$ ，只需求
	$$
	\begin{aligned}
	b_0^2&\equiv&a_0^2&\pmod{x^m}
	\end{aligned}
	$$
	即可\\
	当 $m>1$ ，
	假设已知 $B'(x)$
	$$
	\begin{aligned}
	{B'}^2(x)&\equiv A(x)&\pmod{x^{\lceil\frac{m}{2} \rceil}}
	\end{aligned}
	$$
	那么
	$$
	\begin{aligned}
	({B'}^2(x)-A(x))^2&\equiv0&\pmod{x^m}\\
	({B'}^2(x)+A(x))^2&\equiv4A(x)B'^2(x)&\pmod{x^m}\\
	(\frac{ {B'}^2(x)+A(x)}{2B'(x)})^2&\equiv B^2(x)&\pmod{x^m}\\
	\frac{ {B'}^2(x)+A(x)}{2{B'}(x)}&\equiv B(x)&\pmod{x^m}
	\end{aligned}
	$$
	然后直接递归算就可以了\\
	复杂度为 $T(m)=T(\frac{m}{2})+O(mlogm)=O(mlogm)$ ，虽然套了多项式逆元但是复杂度并没有变大2333\\
	最后多项式平方根的存在性依旧取决与 $a_0$ 是否为二次剩余\\
	如果二次剩余方程有多解，那么该多项式也有多个平方根\\
	\vspace{1cm}
	\subsubsection{多项式除法/取模}
	\paragraph{题意}~\\
	类比平时的除法 $m=pn+q$\\
	给定 $n$ 次多项式 $A(x)$ 和 $m$ 次多项式 $B(X)$ ，求 $C(x)$ 和 $D(X)$ ，满足 $A(x)=B(x)C(x)+D(x)$ ，其中 $C(X)$ 的次数为 $n-m$ ，$D(x)$ 的次数小于 $m$
	\paragraph{题解}~\\
	\textbf{注：题目要用 $0$ 把 $D(x)$ 补成 $m-1$ 次多项式，实际求解中应将 $0$ 系数项去掉，不然会出事}\\
	先定义 $A^R(x)$ 为将 $A$ 系数翻转后的多项式，即 $(a_0,a_1...a_n)\rightarrow(a_n,a_{n-1}...a_0)$\\
	那么如何表示 $A^R(x)$ 呢？可以知道 $A^R(x)=x^nA(\frac{1}{x})$ 和 $A(x)=x^nA^R(\frac{1}{x})$\\
	所以
	$$
	\begin{aligned}
	A(x)&=B(x)*C(x)+D(x)\\
	x^nA^R(\frac{1}{x})&=x^mB^R(\frac{1}{x})*x^{n-m}C^R(\frac{1}{x})+x^{m-1}D^R(\frac{1}{x})\\
	A^R(\frac{1}{x})&=B^R(\frac{1}{x})*C^R(\frac{1}{x})+x^{m-n-1}D^R(\frac{1}{x})\\
	A^R(x)&=B^R(x)*C^R(x)+x^{n-m+1}D^R(x)
	\end{aligned}
	$$
	这里将 $D(x)$ 直接视作 $m-1$ 次多项式进行翻转\\
	然后可以看到，翻转之后，如果将该方程对 $x^{n-m+1}$ 去模，那么$D^R(x)$ 就去掉了，而由于 $C^R(x)$ 是 $n-m$ 次多项式，因此此次去模对他没有影响，所以有
	$$
	A^R(x)\equiv B^R(x)*C^R(x)\pmod{x^{n-m+1}}
	$$
	求解 $A^R(x)$ 的逆元即可得 $C^R(x)$ ，然后代进原方程得 $D(X)$\\
	巧妙的构造。。\\
	\vspace{1cm}
	\subsubsection{多项式对数}
	\paragraph{题意}~\\
	给定多项式 $A(x)$ ，求多项式一个 $\bmod x^n$ 下的多项式 $B(x)$ ，使 $B(x)\equiv lnA(x)\pmod{x^n}$
	\paragraph{题意}~\\
	多项式的对数的含义要结合麦克劳林级数\\
	对 $\displaystyle A(x)=\sum_{i=1}^{\infty}a_ix^i$ ，有 $\displaystyle ln(1-A(x))=-\sum_{i=1}^{\infty}\frac{(A(x))^i}{i!}$\\
	所以对 $ln(A(x))$ 来说，$A(x)$ 需满足常数项为 $1$ ，否则不能做单独的对数运算\\
	如果常数项不为 $1$ ，可以把常数项提出来，可是 $ln a_0$ 这个在模意义下是没有给出定义的 ，所以如果不能处理 $ln a_0$ ，那么该式便无意义\\
	求解 $lnA(x)$ 的方法也很简单，求导之后可得
	$$
	B'(x)\equiv\frac{A'(x)}{A(x)}\pmod{x^n}
	$$
	那么可求得 $B'(x)$ 进而积分 $\int B'(x)dx+C= B(x)+C$ ，由于 $B(0)=ln A(0)=ln 1=0$ ，所以 $C=0$ ，故直接求不定积分就可以得到答案。。\\
	\vspace{1cm}
	\subsubsection{多项式指数}
	\paragraph{题意}~\\
	给定一个多项式 $A(x)$ ，求 $B(x)$ ，满足 $B(x)\equiv e^{A(x)}\pmod{x^n}$
	\paragraph{多项式指数函数的含义}~\\
	仍然对指数函数做麦克劳林展开，得到
	$$
	e^{A(x)}=\sum_{i=0}^{\infty}\frac{A^i(x)}{i!}\pmod{x^n}
	$$\\
	\paragraph{方法一：牛顿迭代法}~\\
	主要思想和之前一样，均是从 $m$ 递推到 $2m$ ，这次给了一个更一般的形式的推导
	已知函数 $G(x)$ ，求多项式 $f(x)\bmod{x^m}$ ，满足
	$$
	G(f(x))\equiv0\pmod{x^m}
	$$
	当 $m=1$ 的时候是模方程的问题
	当 $m>1$ ，假设求出了
	$$
	G(f(x))\equiv0\pmod{x^{\lceil\frac{m}{2} \rceil}}
	$$
	然后考虑对 $G(F(x))$ 在 $f(x)$ 进行泰勒展开
	$$
	G(F(x))=\sum_{k=0}^{\infty} \frac{G^{(k)}(f(x))}{k!}(F(x)-f(x))^k
	$$
	当 $k>2$ 
	$$
	(F(x)-f(x))^k\equiv 0\pmod{x^m}
	$$
	由于 $F(x)$ 满足 
	$$
	G(F(x))\equiv0\pmod{x^{\lceil\frac{m}{2} \rceil}}
	$$
	所以 
	$$
	F(x)\equiv f(x)\pmod{x^{\lceil\frac{m}{2} \rceil}}
	$$
	故
	$$
	G(F(x))\equiv G(f(x))+G'(f(x))(F(x)-f(x))\pmod{x^m}
	$$
	结合
	$$
	G(F(x))\equiv 0\pmod{x^m}
	$$
	化简得
	$$
	F(x)\equiv f(x)-\frac{G(f(x))}{G'(f(x))}\pmod{x^m}
	$$
	将他代入各种多项式操作就可以得到我们之前得出的解法\\
	对指数来说，我们应尽量避免，而此前已经得出对数的解法，所以直接取对数，得
	$$
	\begin{aligned}
	\ln B(x)&\equiv A(x)&\pmod{x^m}\\
	\ln B(x)-A(x)&\equiv 0&\pmod{x^m}
	\end{aligned}
	$$
	令 $G(B(x))=\ln B(x)-A(x)$ ，得\\
	当 $m=1$ 时，$B(x)=e^{a_0}$ ，而由于 $e$ 在模意义下并不能给出定义，所以除指数为 $0$ 外其他数都不能给出定义，因此可以看出多项式指数的存在性依赖于 $a_0$ 是否为 $0$\\
	当 $m>2$ ，直接带入牛顿迭代，得
	$$
	\begin{aligned}
	B(x)&\equiv b(x)-\frac{\ln b(x)-A(x)}{(\ln b(x)-A(x))'}&\pmod{x^m}\\
	B(x)&\equiv b(x)(1-\ln b(x)+A(x)) &\pmod{x^m}\\
	\end{aligned}
	$$
	复杂度为 $T(m)=T(\frac{m}{2})+O(mlogm)=O(mlogm)$ \\
	不造都套上多少层这样的递归式了，每次其实常数都在翻倍，然后这个的常数据说能到达几十。。甚至比下面的分治 $FFT$ 的 $O(mlog^2m)$ 要大，可是窝写出来的分治 $FFT$ 好像更慢qwq\\
	\paragraph{方法二：分治FFT}~\\
	这个的想法比较简单，对两边求导
	$$
	\begin{aligned}
	B'(x)&\equiv A(x)e^{A(x)} &\pmod{x^m}\\
	B'(x)&\equiv A(x)B(x)&\pmod{x^m}\\
	B(x)&\equiv \int A(x)B(x)+C&\pmod{x^m}
	\end{aligned}
	$$
	显然 $C=1$ ，然后这就可以用分治 $FFT$ 做了，窝的写法貌似没别人优秀，所以跑得比上面的要慢。。\\
	\vspace{1cm}
	\subsubsection{多项式多点求值}
	\paragraph{题意}~\\
	给定一个 $n-1$ 次多项式 $F(x)$ 和 $m$ 项序列 $\{a_i\}$ ，对 $\forall i\in[1,m]$，求 $F(a_i)$
	\paragraph{题解}~\\
	主要是利用分治的思想将求值的规模逐渐减少。。\\
	若给定多项式 $F(x)$ ，要在 $X=\{x_0,x_1..x_n\}$ 上进行多点求值\\
	那么可以将 $X$ 分成两半， $X_1=\{x_0,x_1..x_{\lfloor\frac{n}{2} \rfloor} \}$ 和 $X_2=\{x_{\lfloor\frac{n}{2} \rfloor+1}...x_n\}$\\
	另 $A(x)=\prod_{x_i\in X} (x-x_i)$ ，$A_1(x)=\prod_{x_i\in X_1} (x-x_i)$ ，$A_2(x)=\prod_{x_i\in X_2} (x-x_i)$\\
	那么可以构造 $F_1(x)=F(x)\bmod{A_1(x)}$ 和 $F_2(x)=F(x)\bmod{A_2(x)}$\\
	设 $F(x)=Q(x)A_1(x)+F_1(x)$\\
	那么 $\forall x_i\in X_1$ ，$F(x_i)=Q(x_i)A_1(x_i)+F_1(x_i)=F_1(x_i)$\\
	同理 $\forall x_i\in X_2$ ，$F(x_i)=F_2(x_i)$\\
	这样问题就简化成了在 $X_1$ 上对 $F_1(x)$ 进行多点求值和在 $X_2$ 上对 $F_2(x)$ 进行多点求值\\
	对 $A(x)$ 同样可以利用分治预处理出来，两者的复杂度均为 $O(nlog^2n)$ ，但是常数巨大。。\\
	\newpage
	\subsection{多项式全家桶}
	\lstinputlisting{./source/poly.cpp}
	\newpage
	\subsection{常用NTT模数}
	\paragraph{说明：} $n=r2^k+1$ ，$g$ 为 $n$ 的原根
	\begin{center}
		\renewcommand\arraystretch{1.1}
		\renewcommand\tabcolsep{30pt}
		\begin{tabular}{|l|l|l|l|}
			\hline
			 n&r&k&g\\
			 \hline
			 3                   & 1    & 1    & 2    \\
			\hline
			 5                   & 1    & 2    & 2    \\
			\hline
			 17                  & 1    & 4    & 3    \\
			\hline
			 97                  & 3    & 5    & 5    \\
			\hline
			 193                 & 3    & 6    & 5    \\
			\hline
			 257                 & 1    & 8    & 3    \\
			\hline
			 7681                & 15   & 9    & 17   \\
			\hline
			 12289               & 3    & 12   & 11   \\
			\hline
			 40961               & 5    & 13   & 3    \\
			\hline
			 65537               & 1    & 16   & 3    \\
			\hline
			 786433              & 3    & 18   & 10   \\
			\hline
			 5767169             & 11   & 19   & 3    \\
			\hline
			 7340033             & 7    & 20   & 3    \\
			\hline
			 23068673            & 11   & 21   & 3    \\
			\hline
			 104857601           & 25   & 22   & 3    \\
			\hline
			 167772161           & 5    & 25   & 3    \\
			\hline
			 469762049           & 7    & 26   & 3    \\
			\hline
			 1004535809          & 479  & 21   & 3    \\
			\hline
			 2013265921          & 15   & 27   & 31   \\
			\hline
			 2281701377          & 17   & 27   & 3    \\
			\hline
			 3221225473          & 3    & 30   & 5    \\
			\hline
			 75161927681         & 35   & 31   & 3    \\
			\hline
			 77309411329         & 9    & 33   & 7    \\
			\hline
			 206158430209        & 3    & 36   & 22   \\
			\hline
			 2061584302081       & 15   & 37   & 7    \\
			\hline
			 2748779069441       & 5    & 39   & 3    \\
			\hline
			 6597069766657       & 3    & 41   & 5    \\
			\hline
			 39582418599937      & 9    & 42   & 5    \\
			\hline
			 79164837199873      & 9    & 43   & 5    \\
			\hline
			 263882790666241     & 15   & 44   & 7    \\
			\hline
			 1231453023109121    & 35   & 45   & 3    \\
			\hline
			 1337006139375617    & 19   & 46   & 3    \\
			\hline
			 3799912185593857    & 27   & 47   & 5    \\
			\hline
			 4222124650659841    & 15   & 48   & 19   \\
			\hline
			 7881299347898369    & 7    & 50   & 6    \\
			\hline
			 31525197391593473   & 7    & 52   & 3    \\
			\hline
			 180143985094819841  & 5    & 55   & 6    \\
			\hline
			 1945555039024054273 & 27   & 56   & 5    \\
			\hline
			 4179340454199820289 & 29   & 57   & 3    \\
			 \hline
		\end{tabular}
	\end{center}
	\newpage
	\subsection{线性递推}
	\paragraph{问题}~\\
	给定一个 $n$ 阶递推式
	$$
	f(m)=\sum_{k=1}^n a_kf(m-k)
	$$
	给定系数 $a$ 和前 $0\sim n-1$ 项，求 $f(m)$\\
	$n\le32000,m\le10^9$
	\paragraph{算法}
	\begin{enumerate}
		\item 构造 $n$ 次多项式 $G(x)$ ，其中 $g_n=1$ ，$g_i=-a_{n-i}$
		\item 用多项式快速幂求 $H(x)=x^m \bmod{G(x)}$
		\item $\displaystyle f(m)=\sum_{k=0}^{n-1}h_kf(k)$
	\end{enumerate}
	\paragraph{证明}~\\
	可以构造 $n$ 阶转移矩阵 $A_0$ ，现在需要求 $A_0^m$  ，时间复杂度为 $O(n^3\log m)$\\
	但是时间复杂度过高，需要优化\\
	我们构造一个矩阵的多项式 $G(A)$ ，满足 $G(A_0)=0$ ，那么只需要求 $H(A)=A^m\mod{G(A)}$ ，即可求得答案，即
	$$
	\begin{aligned}
	ans=&H(A_0)[1,0...]^T
	\\=&\sum_{k=0}^{n-1}h_kA_0^k[1,0,..]^T
	\\=&\sum_{k=0}^{n-1}h_kf(k)
	\end{aligned}
	$$
	这个利用多项式快速幂就可以了\\
	现在问题的关键是求 $G(A)$ ，由 $Cayley-Hamiton$ 定理可得：$g_n=1$ ，$g_i=-a_{n-i}$\\
	这里的证明暂时还没学qaq\\
	\paragraph{代码}~\\
	\lstinputlisting{./source/bm.cpp}
	\newpage
	\subsection{BM算法}
	直接从别人偷来的板子\\
	直接将前几项(从第 0 项开始)存进一个 vector ，然后用 gao() 函数可以求出第 $n$ 项，复杂度似乎是 $O(m^2logn)$\\
	从 gao() 函数中可以发现系数存在 $c$ 里头，需要的时候那出来用就可以了\\
	\lstinputlisting{./source/BM.cpp}
%	\newpage
%	\subsection{}
%	\lstinputlisting{./source/}
%\end{document}